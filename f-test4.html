<!DOCTYPE html>
<html lang="ko">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>ë¯¸ë˜ì˜ í•˜ë£¨ | thisdive</title>

  <!-- ë‹¨ì¼ íŒŒì¼ ë°ëª¨ìš© CSP (ë°°í¬ ì‹œ app.css/app.js ë¶„ë¦¬ + 'unsafe-inline' ì œê±° ê¶Œì¥) -->
  <meta http-equiv="Content-Security-Policy" content="
    default-src 'self';
    img-src 'self' data:; 
    style-src 'self' 'unsafe-inline';
    script-src 'self' 'unsafe-inline';
    font-src 'self';
    connect-src 'self';
    frame-ancestors 'none';
    base-uri 'self';
    upgrade-insecure-requests
  ">
  <meta name="color-scheme" content="light" />
  <meta name="referrer" content="strict-origin-when-cross-origin">

  <style>
    :root{
      /* ì§€ìœ¤ ë¬´ë“œ íŒ”ë ˆíŠ¸ */
      --bg:#f7f3ed;        /* ì „ì²´ ë°°ê²½ ì—°ë² ì´ì§€ */
      --card:#ffffff;      /* ì¹´ë“œ ë°°ê²½ */
      --fg:#2a3249;        /* ë„¤ì´ë¹„ í…ìŠ¤íŠ¸ */
      --muted:#6b7280;     /* ë³´ì¡° í…ìŠ¤íŠ¸ */
      --rose-50:#fbf2f0;   /* ë§¤ìš° ì—°í•œ ë¡œì¦ˆ */
      --rose-100:#f4e6e2;  /* ì—° ë¡œì¦ˆ */
      --rose-300:#d7a8b5;  /* ì¤‘ê°„ ë¡œì¦ˆ */
      --beige-200:#ece6df; /* ë¼ì¸ */
      --beige-300:#e5ddd3; /* hover */
      --ok:#2a7a4b;        /* í™•ì¸ ìƒ‰ */
      --wrap:310px;        /* â—€ ì¹´ë“œ ë„ˆë¹„ í™• ì¤„ì„ (ê¸°ì¡´ 980px â†’ 560px) */
      --r-xl:22px; --r-md:14px;
    }
    *{box-sizing:border-box}
    html,body{height:100%}
    body{
      margin:0; background:var(--bg); color:var(--fg);
      font-family: system-ui, -apple-system, "Pretendard", "Apple SD Gothic Neo", "Malgun Gothic", "Segoe UI", Roboto, Arial, sans-serif;
      -webkit-font-smoothing:antialiased; -moz-osx-font-smoothing:grayscale;
    }

    /* í—¤ë” */
    .header{position:sticky; top:0; z-index:10; background:var(--bg); border-bottom:1px solid var(--beige-200)}
    .header .inner{max-width:var(--wrap); margin:0 auto; padding:14px 22px; display:flex; align-items:center; justify-content:center}
    .title{font-weight:700}

    /* ë ˆì´ì•„ì›ƒ */
    .wrap{display:grid; place-items:center; padding:22px}
    .card{width:100%; max-width:var(--wrap); background:var(--card); border:1px solid var(--beige-200); border-radius:var(--r-xl); box-shadow:0 8px 24px rgba(0,0,0,.04); overflow:hidden}
    .card-head{padding:22px 22px 10px; border-bottom:1px solid var(--beige-200)}
    .card-head .subtitle{font-size:14px; color:var(--muted)}
    .card-body{padding:18px 22px}
    .section + .section{margin-top:18px}

    /* í•„ë“œ */
    .grid{display:grid; grid-template-columns:1fr; gap:12px} /* â—€ í•œ ì¤„ ë ˆì´ì•„ì›ƒ ê³ ì • */
    /* @media ì œê±°ë¡œ í•­ìƒ 1ì—´ ìœ ì§€ */
    .field{display:flex; flex-direction:column}
    .label{font-size:13px; color:var(--muted); margin-bottom:6px}
    .input, .select{
      width:100%; background:#fff; border:1px solid var(--beige-200); color:var(--fg);
      border-radius:12px; padding:12px 14px; font-size:15px; outline:none;
      transition:border-color .2s ease, box-shadow .2s ease
    }
    .input:focus, .select:focus{border-color:var(--rose-300); box-shadow:0 0 0 3px rgba(215,168,181,.22)}

    /* ì—°/ì›”/ì¼ í•œ ì¤„ & ì»´íŒ©íŠ¸ ìº¡ìŠ */
    .row{display:grid; grid-template-columns:repeat(3, 1fr); gap:8px}
    .row.ymd .input{padding:8px 10px; border-radius:10px; font-size:14px}

    .small{font-size:13px; color:var(--muted)}

    /* ë¯¸ë¦¬ë³´ê¸° */
    .preview{
      padding:14px; background:var(--rose-50); border:1px solid var(--beige-200); border-radius:var(--r-md);
      line-height:1.65
    }
    .preview strong{background:linear-gradient(transparent 58%, var(--rose-100) 0)}

    /* ê°ê° ë””í…Œì¼: í•­ìƒ í•œ ì¤„ì— í•˜ë‚˜ */
    .sense{display:grid; grid-template-columns:1fr; gap:10px}

    /* ì‹œê°í™” ì²´í¬ */
    .visualize{display:flex; align-items:center; gap:10px; padding:14px; background:var(--rose-100); border:1px solid var(--beige-200); border-radius:var(--r-md)}
    .visualize input{width:16px; height:16px}

    /* í‘¸í„° */
    .card-foot{display:flex; align-items:center; justify-content:space-between; gap:12px; padding:16px 22px; border-top:1px solid var(--beige-200); background:#fff}
    .btn{
      appearance:none; border:1px solid var(--beige-200); background:var(--fg); color:#fff;
      padding:12px 18px; border-radius:999px; font-weight:600; font-size:15px; cursor:pointer;
      transition:transform .06s ease, opacity .2s ease
    }
    .btn:hover{opacity:.95}
    .btn:active{transform:translateY(1px)}
    .btn[disabled]{opacity:.45; cursor:not-allowed}
    .btn-secondary{background:#fff; color:var(--fg)}

    /* í† ìŠ¤íŠ¸ */
    .toast{position:fixed; left:50%; bottom:22px; transform:translateX(-50%); background:#111; color:#fff; padding:12px 16px; border-radius:999px; font-size:14px; box-shadow:0 8px 24px rgba(0,0,0,.18); opacity:0; pointer-events:none; transition:opacity .25s ease}
    .toast.show{opacity:1}

    .sr-only{position:absolute; width:1px; height:1px; padding:0; margin:-1px; overflow:hidden; clip:rect(0,0,0,0); white-space:nowrap; border:0}
  </style>
</head>
<body>
  <a class="sr-only" href="#main">ë³¸ë¬¸ ë°”ë¡œê°€ê¸°</a>
  <header class="header">
    <div class="inner"><div class="title">ë¯¸ë˜ì˜ í•˜ë£¨</div></div>
  </header>

  <main id="main" class="wrap">
    <article class="card" aria-labelledby="h1">
      <div class="card-head">
           <div class="subtitle">ë¯¸ë˜ì˜ ë‚˜ì˜ í•˜ë£¨ëŠ” ì–´ë–¨ê¹Œìš”? ë‚´ê°€ ì›í•˜ëŠ” í•˜ë£¨ë¥¼ êµ¬ì²´ì ìœ¼ë¡œ ì ê³ , 1ë¶„ê°„ ê·¸ ì¥ë©´ ì†ì— ë¨¸ë¬¼ëŸ¬ ë³´ì„¸ìš”.</div>
      </div>

      <div class="card-body">
        <!-- ë‚ ì§œ/ì¥ì†Œ/ì¸ë¬¼/í–‰ë™ ê¸°ë³¸ íŒŒíŠ¸ -->
        <section class="section" aria-labelledby="sec-basic">
          <h2 id="sec-basic" class="sr-only">ê¸°ë³¸ ì •ë³´</h2>
          <div class="grid">
            <div class="row ymd">
              <div class="field">
                <label class="label" for="year">ì—°ë„</label>
                <input id="year" class="input" type="number" inputmode="numeric" placeholder="ì˜ˆ) 2026" min="2024" max="2100" />
              </div>
              <div class="field">
                <label class="label" for="month">ì›”</label>
                <input id="month" class="input" type="number" inputmode="numeric" placeholder="ì˜ˆ) 4" min="1" max="12" />
              </div>
              <div class="field">
                <label class="label" for="day">ì¼</label>
                <input id="day" class="input" type="number" inputmode="numeric" placeholder="ì˜ˆ) 15" min="1" max="31" />
              </div>
            </div>
            <div class="field">
              <label class="label" for="place">ì–´ë””ì„œ</label>
              <input id="place" class="input" type="text" placeholder="ì˜ˆ) ì„±ìˆ˜ë™ì˜ ì‘ì—…ì‹¤ì—ì„œ" />
            </div>
            <div class="field">
              <label class="label" for="with">ëˆ„êµ¬ì™€</label>
              <input id="with" class="input" type="text" placeholder="ì˜ˆ) ì¢‹ì•„í•˜ëŠ” ë™ë£Œì™€ í•¨ê»˜" />
            </div>
            <div class="field">
              <label class="label" for="doing">ë¬´ì—‡ì„</label>
              <input id="doing" class="input" type="text" placeholder="ì˜ˆ) ì¦ê²ê²Œ ì‘ì—…ì„ í•˜ê³  ìˆë‹¤" />
            </div>
          </div>
          <div class="small" style="margin-top:6px">ì˜ˆì‹œ: ë‚˜ëŠ” <strong>ë‚´ë…„ ë´„(2026.4)</strong>, <strong>ì„±ìˆ˜ë™ì˜ ì‘ì—…ì‹¤ì—ì„œ</strong> <strong>ì¢‹ì•„í•˜ëŠ” ë™ë£Œì™€ í•¨ê»˜</strong> <strong>ì¦ê²ê²Œ ì‘ì—…í•˜ê³  ìˆë‹¤</strong>.</div>
        </section>

        <!-- ê°ê° ë””í…Œì¼(ì„ íƒ) -->
        <section class="section" aria-labelledby="sec-sense">
          <h2 id="sec-sense" class="sr-only">ê°ê° ë””í…Œì¼</h2>
          <div class="sense">
            <div class="field">
              <label class="label" for="see">ë³´ì´ëŠ” ê²ƒ(ì‹œê°)</label>
              <input id="see" class="input" type="text" placeholder="ì˜ˆ) ì˜¤í›„ í–‡ì‚´, í˜í¼ë¯¼íŠ¸ ì´ˆë¡, ì •ë¦¬ëœ ì±…ìƒ" />
            </div>
            <div class="field">
              <label class="label" for="hear">ë“¤ë¦¬ëŠ” ê²ƒ(ì²­ê°)</label>
              <input id="hear" class="input" type="text" placeholder="ì˜ˆ) ì”ì”í•œ ì¬ì¦ˆ, í‚¤ë³´ë“œ íƒ€ì´í•‘ ì†Œë¦¬" />
            </div>
            <div class="field">
              <label class="label" for="feel">ëŠê»´ì§€ëŠ” ê²ƒ(ì´‰/í›„/ë¯¸ê°)</label>
              <input id="feel" class="input" type="text" placeholder="ì˜ˆ) ì†ëì˜ ë”°ëœ»í•¨, ì€ì€í•œ ì»¤í”¼ í–¥" />
            </div>
          </div>
        </section>

        <!-- ë¯¸ë¦¬ë³´ê¸° 1: ì¥ë©´ ë¬¸ì¥ -->
        <section class="section" aria-labelledby="sec-preview">
          <h2 id="sec-preview" class="sr-only">ë¯¸ë¦¬ë³´ê¸°</h2>
          <div class="preview" id="preview">ë‚˜ëŠ” <strong>____ë…„ ____ì›” ____ì¼</strong>, <strong>____</strong>ì—ì„œ <strong>____</strong>ì™€ í•¨ê»˜ <strong>____</strong>ì„ í•˜ê³  ìˆë‹¤.</div>
        </section>

        <!-- ë¯¸ë¦¬ë³´ê¸° 2: ê°ê° ë¬¸ì¥ -->
        <section class="section" aria-labelledby="sec-preview-sense">
          <h2 id="sec-preview-sense" class="sr-only">ê°ê° ë¯¸ë¦¬ë³´ê¸°</h2>
          <div class="preview" id="preview-sense">ì§€ê¸ˆ ë‚´ ëˆˆ ì•ì—ëŠ” <strong>____</strong>ì´ ë³´ì´ê³ , <strong>____</strong>ì´ ë“¤ë¦¬ê³ , <strong>____</strong>ì´ ëŠê»´ì§„ë‹¤.</div>
        </section>

        <!-- ì‹œê°í™” ì²´í¬ -->
        <section class="section" aria-labelledby="sec-visual">
          <h2 id="sec-visual" class="sr-only">ì‹œê°í™” ì²´í¬</h2>
          <label class="visualize">
            <input type="checkbox" id="visualized" />
            <div>
              <div><strong>ëˆˆì„ ê°ê³  1ë¶„ê°„ ê·¸ ì¥ë©´ì„ ë– ì˜¬ë ¤ ë³´ì•˜ì–´ìš”</strong></div>
              <small>ëª¸ì˜ ê°ê°(ì˜¨ë„/ìì„¸/ë¯¸ì„¸í•œ í‘œì •)ê¹Œì§€ ëŠê»´ë³´ì„¸ìš”.</small>
            </div>
          </label>
        </section>
      </div>

      <div class="card-foot">
        <div class="small" id="hint">í•„ìˆ˜ í•­ëª©(ì—°/ì›”/ì¼/ì¥ì†Œ/ëˆ„êµ¬/ë¬´ì—‡) ì…ë ¥ ì‹œ ë‹¤ìŒ ë‹¨ê³„ë¡œ ì´ë™ ê°€ëŠ¥</div>
        <div style="display:flex; gap:10px">
          <button class="btn btn-secondary" id="btn-clear" type="button">ì´ˆê¸°í™”</button>
          <button class="btn" id="btn-next" type="button" disabled>ë‹¤ìŒ â†’ ëª©í‘œì„¤ì •</button>
        </div>
      </div>
    </article>
  </main>

  <div class="toast" id="toast" role="status" aria-live="polite">ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤</div>

  <script>
    const KEY = 'thisdive_affirmation_scenario_v1';

    // refs
    const yearEl = document.getElementById('year');
    const monthEl = document.getElementById('month');
    const dayEl = document.getElementById('day');
    const placeEl = document.getElementById('place');
    const withEl = document.getElementById('with');
    const doingEl = document.getElementById('doing');
    const seeEl = document.getElementById('see');
    const hearEl = document.getElementById('hear');
    const feelEl = document.getElementById('feel');
    const preview = document.getElementById('preview');
    const previewSense = document.getElementById('preview-sense');
    const visualized = document.getElementById('visualized');
    const nextBtn = document.getElementById('btn-next');
    const clearBtn = document.getElementById('btn-clear');
    const hint = document.getElementById('hint');
    const toast = document.getElementById('toast');

    const state = {
      year:'', month:'', day:'', place:'', with:'', doing:'',
      see:'', hear:'', feel:'', visualized:false
    };

    function save(showToast=false){
      try{ localStorage.setItem(KEY, JSON.stringify(state)); }catch(e){}
      if(showToast) flashToast('ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤');
    }
    function flashToast(msg){
      toast.textContent = msg; toast.classList.add('show');
      setTimeout(()=>toast.classList.remove('show'), 1400);
    }

    function fmt(v){ return (v||'').trim(); }

    function render(){
      const y = fmt(state.year)||'____', m = fmt(state.month)||'__', d = fmt(state.day)||'__';
      const plc = fmt(state.place)||'____';
      const w = fmt(state.with)||'____';
      const act = fmt(state.doing)||'____';
      preview.innerHTML = `ë‚˜ëŠ” <strong>${y}ë…„ ${m}ì›” ${d}ì¼</strong>, <strong>${plc}</strong>ì—ì„œ <strong>${w}</strong>ì™€ í•¨ê»˜ <strong>${act}</strong>ì„ í•˜ê³  ìˆë‹¤.`;

      // ê°ê° ë¯¸ë¦¬ë³´ê¸°
      const s = fmt(state.see)||'____';
      const h = fmt(state.hear)||'____';
      const f = fmt(state.feel)||'____';
      previewSense.innerHTML = `ì§€ê¸ˆ ë‚´ ëˆˆ ì•ì—ëŠ” ğŸ‘ï¸<strong>${s}</strong>ì´ ë³´ì´ê³ , ğŸ‘‚ğŸ»<strong>${h}</strong>ì´ ë“¤ë¦¬ê³ , ğŸ¤šğŸ»<strong>${f}</strong>ì´ ëŠê»´ì§„ë‹¤.`;

      // í•„ìˆ˜ ì²´í¬
      const ok = fmt(state.year) && fmt(state.month) && fmt(state.day) && fmt(state.place) && fmt(state.with) && fmt(state.doing);
      nextBtn.disabled = !ok;
      hint.textContent = ok ? 'ì¢‹ì•„ìš”. ì´ì œ ëª©í‘œì„¤ì •ìœ¼ë¡œ ë„˜ì–´ê°ˆ ìˆ˜ ìˆì–´ìš”.' : 'í•„ìˆ˜ í•­ëª©(ì—°/ì›”/ì¼/ì¥ì†Œ/ëˆ„êµ¬/ë¬´ì—‡)ì„ ì±„ì›Œì£¼ì„¸ìš”.';

      visualized.checked = !!state.visualized;
    }

    function bind(el, key){
      el.addEventListener('input', ()=>{ state[key] = el.value; save(false); render(); });
    }

    [
      [yearEl,'year'], [monthEl,'month'], [dayEl,'day'],
      [placeEl,'place'], [withEl,'with'], [doingEl,'doing'],
      [seeEl,'see'], [hearEl,'hear'], [feelEl,'feel']
    ].forEach(([el,k])=> bind(el,k));

    visualized.addEventListener('change', ()=>{ state.visualized = visualized.checked; save(false); });

    clearBtn.addEventListener('click', ()=>{
      Object.keys(state).forEach(k=> state[k] = (k==='visualized'? false : ''));
      [yearEl,monthEl,dayEl,placeEl,withEl,doingEl,seeEl,hearEl,feelEl].forEach(el=> el.value='');
      save(true); render();
    });

    nextBtn.addEventListener('click', ()=>{
      // ë‹¤ìŒ ë‹¨ê³„ë¡œ ì „ë‹¬ (ì˜ˆ: goal.html)
      try{ sessionStorage.setItem('thisdive_affirmation_scenario_payload', JSON.stringify(state)); }catch(e){}
      flashToast('ì‹œë‚˜ë¦¬ì˜¤ê°€ ì €ì¥ë˜ì—ˆì–´ìš”');
      // TODO: ì‹¤ì œ ê²½ë¡œë¡œ ì´ë™
      // location.href = 'goal.html';
    });

    // ë³µì›
    (function restore(){
      try{
        const raw = localStorage.getItem(KEY);
        if(raw){
          const data = JSON.parse(raw);
          Object.assign(state, data||{});
          yearEl.value = state.year||''; monthEl.value = state.month||''; dayEl.value = state.day||'';
          placeEl.value = state.place||''; withEl.value = state.with||''; doingEl.value = state.doing||'';
          seeEl.value = state.see||''; hearEl.value = state.hear||''; feelEl.value = state.feel||'';
          visualized.checked = !!state.visualized;
        }
      }catch(e){}
      render();
    })();
  </script>
</body>
</html>

